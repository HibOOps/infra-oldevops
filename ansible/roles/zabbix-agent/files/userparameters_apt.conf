# Treat security and regular updates differently
# This is just a simulation, that can be run under zabbix user
# Since updating packages lists (apt-get update) requires root user,
# use APT::Periodic or some other functionality for that
#/etc/zabbix/zabbix_agentd.d/apt.conf
UserParameter=apt.security,apt-get -s dist-upgrade | grep -ci ^inst.*security | tr -d '\n'
UserParameter=apt.updates,apt-get -s dist-upgrade | grep -iPc '^Inst((?!security).)*$' | tr -d '\n'
UserParameter=apt.list.upgradable.packages,apt-get -s dist-upgrade | grep "^Inst" | sed -e 's/Inst\ //' | sed -e 's/)//'
