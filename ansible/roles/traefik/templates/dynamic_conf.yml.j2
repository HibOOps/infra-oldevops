http:
  middlewares:
    secure-headers:
      headers:
        stsSeconds: 31536000
        stsIncludeSubdomains: true
        frameDeny: true
        contentTypeNosniff: true
        browserXssFilter: true
    rate-limit:
      rateLimit:
        average: 1000
        burst: 500

  routers:
    app-frontend:
      rule: "Host(`app.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: app-frontend
      middlewares:
        - secure-headers
    app-backend:
      rule: "Host(`api.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: app-backend
      middlewares:
        - secure-headers
        - rate-limit
    vaultwarden:
      rule: "Host(`vault.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: vaultwarden
    snipeit:
      rule: "Host(`inventory.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: snipeit
    uptimekuma:
      rule: "Host(`status.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: uptimekuma
    zabbix:
      rule: "Host(`monitoring.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: zabbix
    prometheus:
      rule: "Host(`prometheus.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: prometheus
    grafana:
      rule: "Host(`grafana.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: grafana
    netbox:
      rule: "Host(`netbox.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: netbox
    dashboard:
      rule: "Host(`proxy.{{ domain_name }}`)"
      entryPoints:
        - websecure
      tls:
        certResolver: ovh
      service: api@internal

  services:
    vaultwarden:
      loadBalancer:
        servers:
          - url: "http://192.168.1.201:8082"
    snipeit:
      loadBalancer:
        servers:
          - url: "http://192.168.1.201:8081"
    uptimekuma:
      loadBalancer:
        servers:
          - url: "http://192.168.1.202:3001"
    zabbix:
      loadBalancer:
        servers:
          - url: "http://192.168.1.202:8083"
    prometheus:
      loadBalancer:
        servers:
          - url: "http://192.168.1.202:9090"
    grafana:
      loadBalancer:
        servers:
          - url: "http://192.168.1.202:3000"
    netbox:
      loadBalancer:
        servers:
          - url: "http://192.168.1.201:8084"
    app-frontend:
      loadBalancer:
        servers:
          - url: "http://192.168.1.250:3000"
        healthCheck:
          path: /
          interval: 15s
          timeout: 5s
    app-backend:
      loadBalancer:
        servers:
          - url: "http://192.168.1.250:8080"
        healthCheck:
          path: /api/health
          interval: 15s
          timeout: 5s
